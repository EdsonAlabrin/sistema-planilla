<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title th:text="${pageTitle} ?: 'Listado de Planillas'"></title>
</head>
<body>
    <div layout:fragment="content">
        <div class="container mt-5">
            <h2><i class="fas fa-file-invoice-dollar"></i> Listado de Planillas</h2>
            <hr>
            <div th:if="${successMessage}" class="alert alert-success" role="alert" th:text="${successMessage}"></div>
            <div th:if="${errorMessage}" class="alert alert-danger" role="alert" th:text="${errorMessage}"></div>

            <a th:href="@{/planillas/generar}" class="btn btn-primary mb-3"><i class="fas fa-plus-circle"></i> Generar Nueva Planilla</a>

            <div th:if="${planillas.empty}" class="alert alert-info text-center">
                <i class="fas fa-info-circle"></i> No hay planillas generadas. <a th:href="@{/planillas/generar}">¡Genera una ahora!</a>
            </div>

            <div th:unless="${planillas.empty}">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover align-middle">
                        <thead class="bg-dark text-white">
                            <tr>
                                <th>ID Planilla</th>
                                <th>Mes</th>
                                <th>Año</th>
                                <th>Tipo</th>
                                <th>Fecha Generada</th>
                                <!-- Columnas de Totales removidas para coincidir con la entidad Planilla simplificada -->
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr th:each="planilla : ${planillas}">
                                <td th:text="${planilla.idPlanilla}"></td>
                                <td th:text="${planilla.mes}"></td>
                                <td th:text="${planilla.anio}"></td>
                                <td th:text="${planilla.tipoPlanilla}"></td>
                                <td th:text="${#temporals.format(planilla.fechaGenerada, 'dd-MM-yyyy')}"></td>
                                <td>
                                    <a th:href="@{/planillas/detalles/{id}(id=${planilla.idPlanilla})}" class="btn btn-info btn-sm me-1"><i class="fas fa-eye"></i> Ver Detalles</a>
                                    <a th:href="@{/planillas/eliminar/{id}(id=${planilla.idPlanilla})}" class="btn btn-danger btn-sm"
                                       onclick="return confirm('¿Estás seguro de que quieres eliminar esta planilla?');"><i class="fas fa-trash-alt"></i> Eliminar</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
